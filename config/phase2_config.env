# ZION 2.8.3 Phase 2 Configuration
# DNS, Domain, and SSL Certificate Setup

# ============================================================================
# DOMAIN CONFIGURATION
# ============================================================================

# Primary domain
DOMAIN="zionterranova.com"
DOMAIN_WILDCARD="*.zionterranova.com"

# Server configuration
SERVER_IP="91.98.122.165"
SERVER_HOSTNAME="zion-pool-01.hetzner.local"
ADMIN_EMAIL="admin@zionterranova.com"

# DNS Provider (Webglobe)
DNS_PROVIDER="webglobe"
DNS_PROVIDER_URL="https://admin.webglobe.cz"

# ============================================================================
# DNS RECORDS (To be configured manually)
# ============================================================================

# A Record - Main Domain
DNS_A_NAME="zionterranova.com"
DNS_A_TYPE="A"
DNS_A_VALUE="91.98.122.165"
DNS_A_TTL="3600"
DNS_A_PRIORITY="10"

# A Record - Wildcard
DNS_WILDCARD_NAME="*.zion-testnet.io"
DNS_WILDCARD_TYPE="A"
DNS_WILDCARD_VALUE="91.98.122.165"
DNS_WILDCARD_TTL="3600"

# CAA Record - Let's Encrypt
DNS_CAA_NAME="zion-testnet.io"
DNS_CAA_TYPE="CAA"
DNS_CAA_FLAGS="0"
DNS_CAA_TAG="issue"
DNS_CAA_VALUE="letsencrypt.org"
DNS_CAA_TTL="3600"

# DKIM Record (pending email provider configuration)
DNS_DKIM_NAME="default._domainkey.zion-testnet.io"
DNS_DKIM_TYPE="TXT"
DNS_DKIM_VALUE="(pending from email provider)"
DNS_DKIM_TTL="3600"

# DMARC Record
DNS_DMARC_NAME="_dmarc.zion-testnet.io"
DNS_DMARC_TYPE="TXT"
DNS_DMARC_VALUE="v=DMARC1; p=quarantine; rua=mailto:admin@zion-testnet.io; pct=100"
DNS_DMARC_TTL="3600"

# ============================================================================
# SSL CERTIFICATE CONFIGURATION
# ============================================================================

# Certificate parameters
CERT_PROVIDER="letsencrypt"
CERT_TYPE="wildcard"
CERT_DOMAINS=["zion-testnet.io", "*.zion-testnet.io"]
CERT_RENEWAL_DAYS_BEFORE="30"
CERT_AUTO_RENEW="true"

# Certificate paths
CERT_PATH="/etc/letsencrypt/live/zion-testnet.io"
CERT_FULLCHAIN="$CERT_PATH/fullchain.pem"
CERT_PRIVATE_KEY="$CERT_PATH/privkey.pem"
CERT_CHAIN="$CERT_PATH/chain.pem"

# ============================================================================
# NGINX CONFIGURATION
# ============================================================================

# Nginx version
NGINX_VERSION="1.24"

# Listen ports
NGINX_HTTP_PORT="80"
NGINX_HTTPS_PORT="443"

# Upstream services
NGINX_UPSTREAM_WARP="localhost:8545"
NGINX_UPSTREAM_POOL="localhost:3333"
NGINX_UPSTREAM_EXPLORER="localhost:8080"

# Rate limiting
RATE_LIMIT_RPC="10r/s"
RATE_LIMIT_POOL="20r/s"
RATE_LIMIT_API="50r/s"

# Worker configuration
NGINX_WORKER_PROCESSES="auto"
NGINX_WORKER_CONNECTIONS="2048"

# ============================================================================
# SUBDOMAIN ROUTING
# ============================================================================

# API subdomain
SUBDOMAIN_API_NAME="api.zion-testnet.io"
SUBDOMAIN_API_BACKEND="http://localhost:8545"
SUBDOMAIN_API_PATH="/api/rpc"

# Mining Pool subdomain
SUBDOMAIN_POOL_NAME="pool.zion-testnet.io"
SUBDOMAIN_POOL_BACKEND="http://localhost:3333"
SUBDOMAIN_POOL_PROTOCOL="stratum"

# Explorer subdomain
SUBDOMAIN_EXPLORER_NAME="explorer.zion-testnet.io"
SUBDOMAIN_EXPLORER_BACKEND="http://localhost:8080"

# Documentation subdomain
SUBDOMAIN_DOCS_NAME="docs.zion-testnet.io"
SUBDOMAIN_DOCS_PATH="/var/www/zion-testnet/docs"

# ============================================================================
# SECURITY HEADERS
# ============================================================================

# HSTS (HTTP Strict Transport Security)
HEADER_HSTS="max-age=31536000; includeSubDomains; preload"

# X-Content-Type-Options
HEADER_X_CONTENT_TYPE="nosniff"

# X-Frame-Options
HEADER_X_FRAME="SAMEORIGIN"

# X-XSS-Protection
HEADER_X_XSS="1; mode=block"

# Content Security Policy
HEADER_CSP="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src * data:"

# Referrer Policy
HEADER_REFERRER_POLICY="no-referrer-when-downgrade"

# ============================================================================
# CERTBOT CONFIGURATION
# ============================================================================

# Certbot email
CERTBOT_EMAIL="admin@zion-testnet.io"

# Certbot plugins
CERTBOT_AUTHENTICATOR="nginx"
CERTBOT_INSTALLER="nginx"

# Certbot renewal settings
CERTBOT_RENEW_HOOK="systemctl reload nginx"

# ============================================================================
# MONITORING & ALERTS
# ============================================================================

# Health check endpoints
HEALTH_CHECK_INTERVAL="300"  # 5 minutes
HEALTH_CHECK_TIMEOUT="10"

# Alert configuration
ALERT_EMAIL="admin@zion-testnet.io"
ALERT_ENABLE="true"

# Log configuration
LOG_LEVEL="info"
LOG_DIR="/var/log/zion"
LOG_RETENTION_DAYS="30"

# ============================================================================
# TESTING CONFIGURATION
# ============================================================================

# Test endpoints
TEST_ENDPOINT_MAIN="https://zion-testnet.io"
TEST_ENDPOINT_API="https://api.zion-testnet.io"
TEST_ENDPOINT_POOL="https://pool.zion-testnet.io"

# Test methods
TEST_METHOD_HTTP_GET="curl -s -o /dev/null -w '%{http_code}'"
TEST_METHOD_SSL="openssl s_client"
TEST_METHOD_DNS="dig +short"

# ============================================================================
# BACKUP CONFIGURATION
# ============================================================================

# Backup location
BACKUP_LOCATION="/mnt/backup/phase2"
BACKUP_RETENTION_DAYS="30"

# Files to backup
BACKUP_FILES=[
    "/etc/nginx",
    "/etc/letsencrypt",
    "/var/www/zion-testnet"
]

# ============================================================================
# PHASE 2 TIMELINE
# ============================================================================

PHASE_START_DATE="2025-11-01"
PHASE_END_DATE="2025-11-02"
PHASE_DURATION_HOURS="8"

# Task timeline
TASK_DNS_CONFIG_HOURS="1"
TASK_SSL_CERT_HOURS="2"
TASK_NGINX_CONFIG_HOURS="2"
TASK_TESTING_HOURS="2"
TASK_VERIFICATION_HOURS="1"

# ============================================================================
# TROUBLESHOOTING
# ============================================================================

# Debug mode (set to 'true' for verbose output)
DEBUG_MODE="false"

# Log all commands
LOG_COMMANDS="false"

# Keep temporary files for debugging
KEEP_TEMP_FILES="false"

# Contact information for issues
SUPPORT_EMAIL="admin@zion-testnet.io"
SUPPORT_GITHUB="https://github.com/zion-protocol/zion-testnet"
